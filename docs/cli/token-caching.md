# การแคชโทเค็น

เอกสารนี้อธิบายฟีเจอร์การแคชโทเค็นของ Gemini CLI ซึ่งช่วยเพิ่มประสิทธิภาพและลดต้นทุน API

## ภาพรวม

การแคชโทเค็นช่วยลดต้นทุนและเวลาในการตอบสนองโดยการเก็บเนื้อหาที่ใช้บ่อยไว้ในแคช ฟีเจอร์นี้มีประโยชน์อย่างยิ่งสำหรับการสนทนาที่ยาวหรือการใช้งานเนื้อหาซ้ำๆ

## วิธีการทำงาน

### การแคชอัตโนมัติ
- เนื้อหาที่ใช้บ่อยถูกแคชโดยอัตโนมัติ
- ระบบตรวจจับเนื้อหาที่เหมือนกันหรือคล้ายกัน
- การแคชทำงานแบบโปร่งใส

### การประหยัดต้นทุน
- ลดจำนวนโทเค็นที่ต้องประมวลผล
- ประหยัดค่าใช้จ่าย API
- เพิ่มความเร็วในการตอบสนอง

## การตรวจสอบสถิติการแคช

ใช้คำสั่ง `/stats` เพื่อดูข้อมูลการใช้โทเค็นและการแคช:

```
/stats
```

ข้อมูลที่แสดง:
- โทเค็นที่ใช้ทั้งหมด
- โทเค็นที่แคช
- อัตราการประหยัด
- ประวัติการใช้งาน

## การกำหนดค่าการแคช

### การเปิด/ปิดใช้งาน

การแคชโทเค็นเปิดใช้งานโดยดีฟอลต์ แต่สามารถปิดได้ผ่าง settings:

```json
{
  "tokenCaching": {
    "enabled": false
  }
}
```

### การปรับแต่งการแคช

```json
{
  "tokenCaching": {
    "enabled": true,
    "maxCacheSize": "100MB",
    "ttl": "24h"
  }
}
```

## ข้อจำกัดและข้อควรทราบ

### ข้อจำกัด
- รองรับเฉพาะผู้ใช้ API key (Gemini API, Vertex AI)
- ไม่รองรับผู้ใช้ OAuth (Google Personal/Enterprise)
- ขึ้นอยู่กับการรองรับของ API

### การจัดการแคช
- แคชถูกจัดการโดยอัตโนมัติ
- มีการล้างแคชเก่าเป็นระยะ
- สามารถล้างแคชด้วยตนเองได้

## การเพิ่มประสิทธิภาพ

### เคล็ดลับการใช้งาน
- ใช้บริบทที่คล้ายกันซ้ำๆ
- หลีกเลี่ยงการเปลี่ยนแปลงเนื้อหาที่ไม่จำเป็น
- ใช้ไฟล์บริบทที่สม่ำเสมอ

### การตรวจสอบประสิทธิภาพ
- ตรวจสอบสถิติการแคชเป็นระยะ
- วิเคราะห์อัตราการประหยัด
- ปรับปรุงรูปแบบการใช้งาน

## การแก้ไขปัญหา

### ปัญหาทั่วไป
- แคชไม่ทำงาน: ตรวจสอบประเภทการยืนยันตัวตน
- สถิติไม่แสดง: ตรวจสอบการรองรับของ API
- ประสิทธิภาพลดลง: ลองล้างแคช

### การวินิจฉัย
- ใช้คำสั่ง `/stats` เพื่อตรวจสอบสถานะ
- ตรวจสอบ log สำหรับข้อผิดพลาด
- ทดสอบกับเนื้อหาง่ายๆ ก่อน
